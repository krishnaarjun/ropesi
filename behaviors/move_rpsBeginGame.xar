<?xml version="1.0" encoding="UTF-8" ?>
<ChoregrapheProject xmlns="http://www.aldebaran-robotics.com/schema/choregraphe/project.xsd" xar_version="1">
    <Box>
        <name>root</name>
        <robot></robot>
        <id>-1</id>
        <tooltip>Root box of Choregraphe&apos;s project. Highest level possible.</tooltip>
        <bitmap_expanded>1</bitmap_expanded>
        <Bitmaps>
            <bitmap>media/images/box/root.png</bitmap>
        </Bitmaps>
        <plugin></plugin>
        <x>0</x>
        <y>0</y>
        <script>
            <content>
                <![CDATA[]]>
</content>
            <language>4</language>
        </script>
        <Input>
            <name>onLoad</name>
            <type>1</type>
            <type_size>1</type_size>
            <nature>0</nature>
            <inner>1</inner>
            <tooltip>Signal sent when diagram is loaded.</tooltip>
            <id>1</id>
        </Input>
        <Input>
            <name>onStart</name>
            <type>1</type>
            <type_size>1</type_size>
            <nature>2</nature>
            <inner>0</inner>
            <tooltip>Box behavior starts when a signal is received on this input.</tooltip>
            <id>2</id>
        </Input>
        <Input>
            <name>onStop</name>
            <type>1</type>
            <type_size>1</type_size>
            <nature>3</nature>
            <inner>0</inner>
            <tooltip>Box behavior stops when a signal is received on this input.</tooltip>
            <id>3</id>
        </Input>
        <Output>
            <name>onStopped</name>
            <type>1</type>
            <type_size>1</type_size>
            <nature>1</nature>
            <inner>0</inner>
            <tooltip>Signal sent when box behavior is finished.</tooltip>
            <id>4</id>
        </Output>
        <Timeline>
            <fps>10</fps>
            <resources_acquisition>0</resources_acquisition>
            <size>300</size>
            <enable>0</enable>
            <start_frame>0</start_frame>
            <end_frame>-1</end_frame>
            <Waveforms />
            <scale>10</scale>
            <watches />
            <BehaviorLayer>
                <name>behavior_layer1</name>
                <mute>0</mute>
                <BehaviorKeyframe>
                    <name>keyframe1</name>
                    <index>1</index>
                    <bitmap></bitmap>
                    <Diagram>
                        <scale>-1</scale>
                        <Box>
                            <name>RightHand</name>
                            <robot></robot>
                            <id>1</id>
                            <tooltip>Open or close right hand</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/movement/move_arm.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>133</x>
                            <y>28</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.hand = "RHand"

    def onUnload(self):
        #puts code for box cleanup here
        ""

    def onInput_onStart(self):
        ALMotion.closeHand(self.hand)
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        ALMotion.closeHand(self.hand)
        self.onStopped() # activate output of the box]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                        </Box>
                        <Box>
                            <name>setVolume</name>
                            <robot></robot>
                            <id>2</id>
                            <tooltip>Set volume to 0 for world-music&#x0A;Set volume to 100 for hardrock</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/interaction/play_music.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>139</x>
                            <y>149</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.audiodevice = ALProxy("ALAudioDevice")

    def onLoad(self):
        #~ puts code for box initialization here
        pass

    def onUnload(self):
        #~ puts code for box cleanup here
        pass

    def onInput_onStart(self):
        self.audiodevice.setOutputVolume(self.getParameter("volume"))
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        self.onUnload() #~ it is recommanded to call onUnload of this box in a onStop method, as the code written in onUnload is used to stop the box as well
        pass]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Starts music</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop music</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>When music is over</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>volume</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>87</value>
                                <default_value>50</default_value>
                                <min>0</min>
                                <max>100</max>
                                <tooltip>percentage of output volume</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Wait</name>
                            <robot></robot>
                            <id>4</id>
                            <tooltip>The wait that can be stopped immediately and reset at any time.&#x0A;&#x0A;Stopping the box won&apos;t output a signal.&#x0A;*** ref box in: ./4_localize/Time/Wait/ExampleWait.xar ***&#x0A;*** last modification date(svn): Version it! ***</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/wait.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>149</x>
                            <y>483</y>
                            <script>
                                <content>
                                    <![CDATA[import threading # opkg install python-threading
class MyClass(GeneratedClass):
  def __init__(self):
    GeneratedClass.__init__(self)
    self.tb = False;
  
  def onUnload(self):
    self.onInput_onStop();
    
  def triggerOutput( self, rPeriod = 1 ):
    self.timerOutput();
    self.onInput_onStop(); # to clean everything
  
  def startTimer( self, rPeriod = 1 ):
    if( self.tb ):
      self.tb.cancel();
    self.tb = threading.Timer( rPeriod, self.triggerOutput, [rPeriod] );
    self.tb.start();

  def onInput_onStart(self):
    self.startTimer( self.getParameter("timeout") );
  
  def onInput_onStop(self):
    if( self.tb ):
      self.tb.cancel();
      self.tb = False;]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Start the timer with a specified period value (in seconds)</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop the timer</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>timerOutput</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>send a bang after a certain amount of time.&#x0A;Warning: not outputted if stopped before time lapse.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>timeout</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>2</content_type>
                                <value>0.2</value>
                                <default_value>1</default_value>
                                <min>0</min>
                                <max>5000</max>
                                <tooltip>After how many seconds the box will timeout and stimulate its ouput.</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Wait</name>
                            <robot></robot>
                            <id>3</id>
                            <tooltip>The wait that can be stopped immediately and reset at any time.&#x0A;&#x0A;Stopping the box won&apos;t output a signal.&#x0A;*** ref box in: ./4_localize/Time/Wait/ExampleWait.xar ***&#x0A;*** last modification date(svn): Version it! ***</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/wait.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>149</x>
                            <y>281</y>
                            <script>
                                <content>
                                    <![CDATA[import threading # opkg install python-threading
class MyClass(GeneratedClass):
  def __init__(self):
    GeneratedClass.__init__(self)
    self.tb = False;
  
  def onUnload(self):
    self.onInput_onStop();
    
  def triggerOutput( self, rPeriod = 1 ):
    self.timerOutput();
    self.onInput_onStop(); # to clean everything
  
  def startTimer( self, rPeriod = 1 ):
    if( self.tb ):
      self.tb.cancel();
    self.tb = threading.Timer( rPeriod, self.triggerOutput, [rPeriod] );
    self.tb.start();

  def onInput_onStart(self):
    self.startTimer( self.getParameter("timeout") );
  
  def onInput_onStop(self):
    if( self.tb ):
      self.tb.cancel();
      self.tb = False;]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Start the timer with a specified period value (in seconds)</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop the timer</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>timerOutput</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>send a bang after a certain amount of time.&#x0A;Warning: not outputted if stopped before time lapse.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>timeout</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>2</content_type>
                                <value>2</value>
                                <default_value>1</default_value>
                                <min>0</min>
                                <max>5000</max>
                                <tooltip>After how many seconds the box will timeout and stimulate its ouput.</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Wait</name>
                            <robot></robot>
                            <id>5</id>
                            <tooltip>The wait that can be stopped immediately and reset at any time.&#x0A;&#x0A;Stopping the box won&apos;t output a signal.&#x0A;*** ref box in: ./4_localize/Time/Wait/ExampleWait.xar ***&#x0A;*** last modification date(svn): Version it! ***</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/wait.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>149</x>
                            <y>604</y>
                            <script>
                                <content>
                                    <![CDATA[import threading # opkg install python-threading
class MyClass(GeneratedClass):
  def __init__(self):
    GeneratedClass.__init__(self)
    self.tb = False;
  
  def onUnload(self):
    self.onInput_onStop();
    
  def triggerOutput( self, rPeriod = 1 ):
    self.timerOutput();
    self.onInput_onStop(); # to clean everything
  
  def startTimer( self, rPeriod = 1 ):
    if( self.tb ):
      self.tb.cancel();
    self.tb = threading.Timer( rPeriod, self.triggerOutput, [rPeriod] );
    self.tb.start();

  def onInput_onStart(self):
    self.startTimer( self.getParameter("timeout") );
  
  def onInput_onStop(self):
    if( self.tb ):
      self.tb.cancel();
      self.tb = False;]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Start the timer with a specified period value (in seconds)</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop the timer</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>timerOutput</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>send a bang after a certain amount of time.&#x0A;Warning: not outputted if stopped before time lapse.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>timeout</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>2</content_type>
                                <value>0.2</value>
                                <default_value>1</default_value>
                                <min>0</min>
                                <max>5000</max>
                                <tooltip>After how many seconds the box will timeout and stimulate its ouput.</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Wait</name>
                            <robot></robot>
                            <id>6</id>
                            <tooltip>The wait that can be stopped immediately and reset at any time.&#x0A;&#x0A;Stopping the box won&apos;t output a signal.&#x0A;*** ref box in: ./4_localize/Time/Wait/ExampleWait.xar ***&#x0A;*** last modification date(svn): Version it! ***</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/wait.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>152</x>
                            <y>380</y>
                            <script>
                                <content>
                                    <![CDATA[import threading # opkg install python-threading
class MyClass(GeneratedClass):
  def __init__(self):
    GeneratedClass.__init__(self)
    self.tb = False;
  
  def onUnload(self):
    self.onInput_onStop();
    
  def triggerOutput( self, rPeriod = 1 ):
    self.timerOutput();
    self.onInput_onStop(); # to clean everything
  
  def startTimer( self, rPeriod = 1 ):
    if( self.tb ):
      self.tb.cancel();
    self.tb = threading.Timer( rPeriod, self.triggerOutput, [rPeriod] );
    self.tb.start();

  def onInput_onStart(self):
    self.startTimer( self.getParameter("timeout") );
  
  def onInput_onStop(self):
    if( self.tb ):
      self.tb.cancel();
      self.tb = False;]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Start the timer with a specified period value (in seconds)</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop the timer</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>timerOutput</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>send a bang after a certain amount of time.&#x0A;Warning: not outputted if stopped before time lapse.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>timeout</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>2</content_type>
                                <value>0.2</value>
                                <default_value>1</default_value>
                                <min>0</min>
                                <max>5000</max>
                                <tooltip>After how many seconds the box will timeout and stimulate its ouput.</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Say</name>
                            <robot></robot>
                            <id>9</id>
                            <tooltip>Say the sentence asked. See box parameters for fine tuning of the voice.</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/interaction/say.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>285</x>
                            <y>384</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.tts = ALProxy('ALTextToSpeech')
        self.ttsStop = ALProxy('ALTextToSpeech', True) #Create another proxy as wait is blocking if audioout is remote
        
    def onLoad(self):
        #puts code for box cleanup here
        self.ids = []
        
    def onUnload(self):
        #puts code for box cleanup here    
        for id in self.ids:
            try:
                self.ttsStop.stop(id)
            except:
                pass
        
    def onInput_onStart(self):
        sentence = "\RSPD="+ str( self.getParameter("speed") )+ "\ "
        sentence += "\VCT="+ str( self.getParameter("Voice Shaping") ) + "\ " 
        sentence += self.getParameter("text")
        sentence +=  "\RST\ "
        id = self.tts.post.say(str(sentence))
        self.ids.append(id)
        self.tts.wait(id, 0)
        self.ids.remove(id)
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        self.onUnload()]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this Input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this Input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when Box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>text</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>3</content_type>
                                <value>paper!</value>
                                <default_value>Hello</default_value>
                                <custom_choice>0</custom_choice>
                                <tooltip>Text to synthesize.</tooltip>
                                <id>5</id>
                            </Parameter>
                            <Parameter>
                                <name>Voice Shaping</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>150</max>
                                <tooltip>This tag is used to modify at runtime the voice feature (tone, speed) in way slightly different of what pitch and speed modification does, giving a kind of &quot;gender or age modification &quot; effect.&#x0A;&#x0A;To better tune the effect, one should compensate the speed modification due to the value parameter. For exemple to keep an average constant speed, one should add 20% to speed parameter when decreasing 20% to the Voice Shaping (VCT) parameter :&#x0A;&#x0A;A quite good male derivation of female voice for example could be obtained using the following parameters: VCT=78.</tooltip>
                                <id>6</id>
                            </Parameter>
                            <Parameter>
                                <name>speed</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>200</max>
                                <tooltip>change the speed of the voice</tooltip>
                                <id>7</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Say</name>
                            <robot></robot>
                            <id>8</id>
                            <tooltip>Say the sentence asked. See box parameters for fine tuning of the voice.</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/interaction/say.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>285</x>
                            <y>610</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.tts = ALProxy('ALTextToSpeech')
        self.ttsStop = ALProxy('ALTextToSpeech', True) #Create another proxy as wait is blocking if audioout is remote
        
    def onLoad(self):
        #puts code for box cleanup here
        self.ids = []
        
    def onUnload(self):
        #puts code for box cleanup here    
        for id in self.ids:
            try:
                self.ttsStop.stop(id)
            except:
                pass
        
    def onInput_onStart(self):
        sentence = "\RSPD="+ str( self.getParameter("speed") )+ "\ "
        sentence += "\VCT="+ str( self.getParameter("Voice Shaping") ) + "\ " 
        sentence += self.getParameter("text")
        sentence +=  "\RST\ "
        id = self.tts.post.say(str(sentence))
        self.ids.append(id)
        self.tts.wait(id, 0)
        self.ids.remove(id)
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        self.onUnload()]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this Input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this Input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when Box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>text</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>3</content_type>
                                <value>GO!</value>
                                <default_value>Hello</default_value>
                                <custom_choice>0</custom_choice>
                                <tooltip>Text to synthesize.</tooltip>
                                <id>5</id>
                            </Parameter>
                            <Parameter>
                                <name>Voice Shaping</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>150</max>
                                <tooltip>This tag is used to modify at runtime the voice feature (tone, speed) in way slightly different of what pitch and speed modification does, giving a kind of &quot;gender or age modification &quot; effect.&#x0A;&#x0A;To better tune the effect, one should compensate the speed modification due to the value parameter. For exemple to keep an average constant speed, one should add 20% to speed parameter when decreasing 20% to the Voice Shaping (VCT) parameter :&#x0A;&#x0A;A quite good male derivation of female voice for example could be obtained using the following parameters: VCT=78.</tooltip>
                                <id>6</id>
                            </Parameter>
                            <Parameter>
                                <name>speed</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>200</max>
                                <tooltip>change the speed of the voice</tooltip>
                                <id>7</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Say</name>
                            <robot></robot>
                            <id>10</id>
                            <tooltip>Say the sentence asked. See box parameters for fine tuning of the voice.</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/interaction/say.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>286</x>
                            <y>486</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.tts = ALProxy('ALTextToSpeech')
        self.ttsStop = ALProxy('ALTextToSpeech', True) #Create another proxy as wait is blocking if audioout is remote
        
    def onLoad(self):
        #puts code for box cleanup here
        self.ids = []
        
    def onUnload(self):
        #puts code for box cleanup here    
        for id in self.ids:
            try:
                self.ttsStop.stop(id)
            except:
                pass
        
    def onInput_onStart(self):
        sentence = "\RSPD="+ str( self.getParameter("speed") )+ "\ "
        sentence += "\VCT="+ str( self.getParameter("Voice Shaping") ) + "\ " 
        sentence += self.getParameter("text")
        sentence +=  "\RST\ "
        id = self.tts.post.say(str(sentence))
        self.ids.append(id)
        self.tts.wait(id, 0)
        self.ids.remove(id)
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        self.onUnload()]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this Input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this Input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when Box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>text</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>3</content_type>
                                <value>sissers!</value>
                                <default_value>Hello</default_value>
                                <custom_choice>0</custom_choice>
                                <tooltip>Text to synthesize.</tooltip>
                                <id>5</id>
                            </Parameter>
                            <Parameter>
                                <name>Voice Shaping</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>150</max>
                                <tooltip>This tag is used to modify at runtime the voice feature (tone, speed) in way slightly different of what pitch and speed modification does, giving a kind of &quot;gender or age modification &quot; effect.&#x0A;&#x0A;To better tune the effect, one should compensate the speed modification due to the value parameter. For exemple to keep an average constant speed, one should add 20% to speed parameter when decreasing 20% to the Voice Shaping (VCT) parameter :&#x0A;&#x0A;A quite good male derivation of female voice for example could be obtained using the following parameters: VCT=78.</tooltip>
                                <id>6</id>
                            </Parameter>
                            <Parameter>
                                <name>speed</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>200</max>
                                <tooltip>change the speed of the voice</tooltip>
                                <id>7</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Say</name>
                            <robot></robot>
                            <id>11</id>
                            <tooltip>Say the sentence asked. See box parameters for fine tuning of the voice.</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/interaction/say.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>292</x>
                            <y>282</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self)
        self.tts = ALProxy('ALTextToSpeech')
        self.ttsStop = ALProxy('ALTextToSpeech', True) #Create another proxy as wait is blocking if audioout is remote
        
    def onLoad(self):
        #puts code for box cleanup here
        self.ids = []
        
    def onUnload(self):
        #puts code for box cleanup here    
        for id in self.ids:
            try:
                self.ttsStop.stop(id)
            except:
                pass
        
    def onInput_onStart(self):
        sentence = "\RSPD="+ str( self.getParameter("speed") )+ "\ "
        sentence += "\VCT="+ str( self.getParameter("Voice Shaping") ) + "\ " 
        sentence += self.getParameter("text")
        sentence +=  "\RST\ "
        id = self.tts.post.say(str(sentence))
        self.ids.append(id)
        self.tts.wait(id, 0)
        self.ids.remove(id)
        self.onStopped() # activate output of the box

    def onInput_onStop(self):
        self.onUnload()]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this Input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this Input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when Box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>text</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>3</content_type>
                                <value>Rock!</value>
                                <default_value>Hello</default_value>
                                <custom_choice>0</custom_choice>
                                <tooltip>Text to synthesize.</tooltip>
                                <id>5</id>
                            </Parameter>
                            <Parameter>
                                <name>Voice Shaping</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>150</max>
                                <tooltip>This tag is used to modify at runtime the voice feature (tone, speed) in way slightly different of what pitch and speed modification does, giving a kind of &quot;gender or age modification &quot; effect.&#x0A;&#x0A;To better tune the effect, one should compensate the speed modification due to the value parameter. For exemple to keep an average constant speed, one should add 20% to speed parameter when decreasing 20% to the Voice Shaping (VCT) parameter :&#x0A;&#x0A;A quite good male derivation of female voice for example could be obtained using the following parameters: VCT=78.</tooltip>
                                <id>6</id>
                            </Parameter>
                            <Parameter>
                                <name>speed</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>1</content_type>
                                <value>100</value>
                                <default_value>100</default_value>
                                <min>50</min>
                                <max>200</max>
                                <tooltip>change the speed of the voice</tooltip>
                                <id>7</id>
                            </Parameter>
                        </Box>
                        <Box>
                            <name>Movement</name>
                            <robot></robot>
                            <id>7</id>
                            <tooltip>This box is empty (contains a single motion layer with no motors defined in it) and should be used to create any movement you&apos;d like.</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/movement/move.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>293</x>
                            <y>96</y>
                            <script>
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
	def __init__(self):
		GeneratedClass.__init__(self)

	def onUnload(self):
		#puts code for box cleanup here
		""

	def onInput_onStart(self):
		#self.onStopped() # activate output of the box
		""

	def onInput_onStop(self):
		""]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when Diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior starts when a signal is received on this Input.</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Box behavior stops when a signal is received on this Input.</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>onStopped</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>1</nature>
                                <inner>0</inner>
                                <tooltip>Signal sent when Box behavior is finished.</tooltip>
                                <id>4</id>
                            </Output>
                            <Timeline>
                                <fps>15</fps>
                                <resources_acquisition>0</resources_acquisition>
                                <size>300</size>
                                <enable>1</enable>
                                <start_frame>0</start_frame>
                                <end_frame>-1</end_frame>
                                <Waveforms />
                                <scale>10</scale>
                                <watches />
                                <ActuatorList>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>HeadYaw</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>HeadPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LShoulderPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>110</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>110</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LShoulderRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>20</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>20</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LElbowYaw</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>-80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>-80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LElbowRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>-80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>-80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LWristYaw</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LHand</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RShoulderPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>0</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>4.5</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>101.6</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>30</frame>
                                                <value>7.5</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>40</frame>
                                                <value>100</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>50</frame>
                                                <value>17</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>60</frame>
                                                <value>100.1</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>70</frame>
                                                <value>40.3</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RShoulderRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>-36.4</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>-36.4</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RElbowYaw</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RElbowRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                        <CurveKeys>
                                            <Key>
                                                <frame>10</frame>
                                                <value>80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                            <Key>
                                                <frame>20</frame>
                                                <value>80</value>
                                                <Tangents>
                                                    <Tangent>
                                                        <side>left</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>-3.33333</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                    <Tangent>
                                                        <side>right</side>
                                                        <interpType>bezier auto</interpType>
                                                        <abscissaParam>0</abscissaParam>
                                                        <ordinateParam>0</ordinateParam>
                                                    </Tangent>
                                                </Tangents>
                                                <smooth>0</smooth>
                                                <symmetrical>0</symmetrical>
                                            </Key>
                                        </CurveKeys>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RWristYaw</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RHand</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LHipYawPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LHipRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LHipPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LKneePitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LAnklePitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>LAnkleRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RHipRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RHipPitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RKneePitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RAnklePitch</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                    <ActuatorCurve>
                                        <name>value</name>
                                        <actuator>RAnkleRoll</actuator>
                                        <recordable>1</recordable>
                                        <mute>1</mute>
                                        <alwaysVisible>0</alwaysVisible>
                                    </ActuatorCurve>
                                </ActuatorList>
                            </Timeline>
                        </Box>
                        <Box>
                            <name>Wait</name>
                            <robot></robot>
                            <id>12</id>
                            <tooltip>The wait that can be stopped immediately and reset at any time.&#x0A;&#x0A;Stopping the box won&apos;t output a signal.&#x0A;*** ref box in: ./4_localize/Time/Wait/ExampleWait.xar ***&#x0A;*** last modification date(svn): Version it! ***</tooltip>
                            <bitmap_expanded>1</bitmap_expanded>
                            <Bitmaps>
                                <bitmap>media/images/box/wait.png</bitmap>
                            </Bitmaps>
                            <plugin></plugin>
                            <x>478</x>
                            <y>572</y>
                            <script>
                                <content>
                                    <![CDATA[import threading # opkg install python-threading
class MyClass(GeneratedClass):
  def __init__(self):
    GeneratedClass.__init__(self)
    self.tb = False;
  
  def onUnload(self):
    self.onInput_onStop();
    
  def triggerOutput( self, rPeriod = 1 ):
    self.timerOutput();
    self.onInput_onStop(); # to clean everything
  
  def startTimer( self, rPeriod = 1 ):
    if( self.tb ):
      self.tb.cancel();
    self.tb = threading.Timer( rPeriod, self.triggerOutput, [rPeriod] );
    self.tb.start();

  def onInput_onStart(self):
    self.startTimer( self.getParameter("timeout") );
  
  def onInput_onStop(self):
    if( self.tb ):
      self.tb.cancel();
      self.tb = False;]]>
</content>
                                <language>4</language>
                            </script>
                            <Input>
                                <name>onLoad</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>0</nature>
                                <inner>1</inner>
                                <tooltip>Signal sent when diagram is loaded.</tooltip>
                                <id>1</id>
                            </Input>
                            <Input>
                                <name>onStart</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>Start the timer with a specified period value (in seconds)</tooltip>
                                <id>2</id>
                            </Input>
                            <Input>
                                <name>onStop</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>3</nature>
                                <inner>0</inner>
                                <tooltip>Stop the timer</tooltip>
                                <id>3</id>
                            </Input>
                            <Output>
                                <name>timerOutput</name>
                                <type>1</type>
                                <type_size>1</type_size>
                                <nature>2</nature>
                                <inner>0</inner>
                                <tooltip>send a bang after a certain amount of time.&#x0A;Warning: not outputted if stopped before time lapse.</tooltip>
                                <id>4</id>
                            </Output>
                            <Parameter>
                                <name>timeout</name>
                                <inherits_from_parent>0</inherits_from_parent>
                                <content_type>2</content_type>
                                <value>1</value>
                                <default_value>1</default_value>
                                <min>0</min>
                                <max>5000</max>
                                <tooltip>After how many seconds the box will timeout and stimulate its ouput.</tooltip>
                                <id>5</id>
                            </Parameter>
                        </Box>
                        <Link>
                            <inputowner>3</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>0</outputowner>
                            <indexofoutput>2</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>11</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>3</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>9</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>6</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>6</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>11</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>1</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>0</outputowner>
                            <indexofoutput>2</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>7</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>1</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>2</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>0</outputowner>
                            <indexofoutput>2</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>10</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>4</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>4</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>9</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>8</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>5</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>5</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>10</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>12</inputowner>
                            <indexofinput>2</indexofinput>
                            <outputowner>8</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                        <Link>
                            <inputowner>0</inputowner>
                            <indexofinput>4</indexofinput>
                            <outputowner>12</outputowner>
                            <indexofoutput>4</indexofoutput>
                        </Link>
                    </Diagram>
                </BehaviorKeyframe>
            </BehaviorLayer>
            <ActuatorList />
        </Timeline>
    </Box>
</ChoregrapheProject>
